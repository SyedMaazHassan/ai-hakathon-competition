{% extends "core/new_base.html" %}

{% block title %}{{ resume.metadata.personal_info.full_name }} | Frontline Assistant AI{% endblock %}
{% block current_page %}Resumes{% endblock %}
{% block page_title %}{{ resume.metadata.personal_info.full_name }}{% endblock %}
{% block page_subtitle %}{{ resume.metadata.personal_info.professional_title }}{% endblock %}

{% block content %}
<div class="max-w-6xl mx-auto">
  <!-- Header with back button and actions -->
  <div class="flex items-center gap-4">
    <a href="{% url 'hiring:resumes_list' %}">
      <button class="w-9 h-9 inline-flex items-center justify-center rounded-md border border-orange-300 dark:border-orange-400/30 dark:text-orange-200">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="m12 19-7-7 7-7"/>
          <path d="M19 12H5"/>
        </svg>
      </button>
    </a>
    <div class="flex-1">
      <h1 class="text-3xl font-bold tracking-tight dark:text-white">{{ resume.metadata.personal_info.full_name|default:"Candidate" }}</h1>
      <div class="flex items-center gap-4 text-orange-700 dark:text-orange-300 mt-2">
        <div class="flex items-center gap-1">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 dark:text-orange-300" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <rect width="20" height="16" x="2" y="4" rx="2"/>
            <path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/>
          </svg>
          <span>{{ resume.metadata.contact_info.email|default:"—" }}</span>
        </div>
        <div class="flex items-center gap-1">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 dark:text-orange-300" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 极 0 0 1 22 16.92z"/>
          </svg>
          <span>{{ resume.metadata.contact_info.phone|default:"—" }}</span>
        </div>
        <div class="flex items-center gap-1">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 dark:text-orange-300" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M12 2c-4.97 0-9 4.03-9 9 0 4.97 4.03 9 9 9 4.97 0 9-4.03 9-9 0-4.97-4.03-9-9-9z"/>
            <path d="M12 6v6l4 2"/>
          </svg>
          <span>Uploaded {{ resume.created_at|date:"M j, Y" }}</span>
        </div>
      </div>
    </div>
    <div class="flex gap-2">
      {% if resume.metadata.contact_info.email %}
      <a href="mailto:{{ resume.metadata.contact_info.email }}" class="inline-flex items-center h-9 px-4 rounded-md border border-orange-300 dark:border-orange-400/30 text-sm font-medium text-orange-700 dark:text-orange-200 bg-white hover:bg-orange-50">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 mr-2" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <rect width="20" height="16" x="2" y="4" rx="2"/>
          <path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/>
        </svg>
        Contact
      </a>
      {% endif %}
      <a href="{{ resume.file.url }}" download class="inline-flex items-center h-9 px-4 rounded-md text-white bg-orange-500 hover:bg-orange-600 text-sm font-medium">
        <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 mr-2" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 极 0 0 1-2-2v-4"/>
          <polyline points="7 10 12 15 17 10"/>
          <line x1="12" x2="12" y1="15" y2="3"/>
        </svg>
        Download
      </a>
    </div>
  </div>

  <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mt-6">
    <!-- Left Column (2/3 width) -->
    <div class="lg:col-span-2 space-y-6">
      <!-- Professional Summary -->
      {% if resume.metadata.personal_info.summary %}
      <div class="bg-orange-50 dark:bg-gray-800 border border-orange-200 dark:border-orange-400/30 rounded-xl">
        <div class="p-6 pb-4">
          <h2 class="text-xl font-semibold flex items-center gap-2 dark:text-white">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="12" cy="12" r="10"/>
              <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/>
              <path d="M12 17h.01"/>
            </svg>
            Professional Summary
          </h2>
        </div>
        <div class="px-6 pb-6 text-orange-800 dark:text-orange-200">
          <p>{{ resume.metadata.personal_info.summary }}</p>
        </div>
      </div>
      {% endif %}

      <!-- Work Experience -->
      {% if resume.metadata.work_experience %}
      <div class="bg-orange-50 dark:bg-gray-800 border border-orange-200 dark:border-orange-400/30 rounded-xl">
        <div class="p-6 pb-4">
          <h2 class="text-xl font-semibold flex items-center gap-2 dark:text-white">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <rect width="20" height="14" x="2" y="5" rx="2"/>
              <path d="M2 10h20"/>
            </svg>
            Work Experience
          </h2>
        </div>
        <div class="px-6 pb-6">
          {% for experience in resume.metadata.work_experience %}
          <div class="mb-6 last:mb-0">
            <div class="flex justify-between items-start">
              <h3 class="font-semibold text-lg dark:text-white">{{ experience.position }}</h3>
              <span class="text-sm text-orange-700 dark:text-orange-300 bg-orange-100 dark:bg-orange-900/40 px-2 py-1 rounded">
                {% if experience.is_current %}Present{% else %}
                  {% if experience.end_date %}
                    {{ experience.start_date.month }}/{{ experience.start_date.year }} - {{ experience.end_date.month }}/{{ experience.end_date.year }}
                  {% else %}
                    {{ experience.start_date.month }}/{{ experience.start_date.year }} - Present
                  {% endif %}
                {% endif %}
              </span>
            </div>
            <p class="text-orange-700 dark:text-orange-300 font-medium">{{ experience.company }} - {{ experience.location }}</p>

            {% if experience.description %}
            <p class="mt-2 text-orange-800 dark:text-orange-200">{{ experience.description }}</p>
            {% endif %}

            {% if experience.responsibilities %}
            <div class="mt-3">
              <h4 class="font-medium text-orange-900 dark:text-orange-200">Key Responsibilities:</h4>
              <ul class="mt-2 space-y-1">
                {% for responsibility in experience.responsibilities %}
                <li class="text-orange-800 dark:text-orange-200 flex items-start">
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 mr-2 mt-1 text-orange-500 flex-shrink-0" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/>
                  </svg>
                  <span>{{ responsibility }}</span>
                </li>
                {% endfor %}
              </ul>
            </div>
            {% endif %}

            {% if experience.technologies_used %}
            <div class="mt-3">
              <h4 class="font-medium text-orange-900 dark:text-orange-200">Technologies Used:</h4>
              <div class="flex flex-wrap gap-2 mt-2">
                {% for tech in experience.technologies_used %}
                <span class="px-2 py-1 text-xs font-medium rounded bg-orange-100 text-orange-800 border border-orange-200 dark:bg-orange-900/40 dark:text-orange-200 dark:border-orange-900/50">{{ tech }}</span>
                {% endfor %}
              </div>
            </div>
            {% endif %}
          </div>
          {% if not forloop.last %}<hr class="my-4 border-orange-200 dark:border-orange-900/50">{% endif %}
          {% endfor %}
        </div>
      </div>
      {% endif %}

      <!-- Projects -->
      {% if resume.metadata.projects %}
      <div class="bg-orange-50 dark:bg-gray-800 border border-orange-200 dark:border-orange-400/30 rounded-xl">
        <div class="p-6 pb-4">
          <h2 class="text-xl font-semibold flex items-center gap-2 dark:text-white">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 极 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"/>
              <path d="M14 2v4a2 2 0 0 0 2 2h4"/>
              <path d="M8 13h8"/>
              <path d="M8 17h6"/>
            </svg>
            Projects
          </h2>
        </div>
        <div class="px-6 pb-6">
          {% for project in resume.metadata.projects %}
          <div class="mb-6 last:mb-0">
            <h3 class="font-semibold text-lg dark:text-white">{{ project.name }}</h3>

            {% if project.description %}
            <p class="mt-2 text-orange-800 dark:text-orange-200">{{ project.description }}</p>
            {% endif %}

            {% if project.technologies %}
            <div class="mt-3">
              <h4 class="font-medium text-orange-900 dark:text-orange-200">Technologies:</h4>
              <div class="flex flex-wrap gap-2 mt-2">
                {% for tech in project.technologies %}
                <span class="px-2 py-1 text-xs font-medium rounded bg-orange-100 text-orange-800 border border-orange-200 dark:bg-orange-900/40 dark:text-orange-200 dark:border-orange-900/50">{{ tech }}</span>
                {% endfor %}
              </div>
            </div>
            {% endif %}

            {% if project.achievements %}
            <div class="mt-3">
              <h4 class="font-medium text-orange-900">Achievements:</h4>
              <ul class="mt-2 space-y-1">
                {% for achievement in project.achievements %}
                <li class="text-orange-800 flex items-start">
                  <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 mr-2 mt-1 text-orange-500 flex-shrink-0" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/>
                    <polyline points="22 4 12 14.01 9 11.01"/>
                  </svg>
                  <span>{{ achievement }}</span>
                </li>
                {% endfor %}
              </ul>
            </div>
            {% endif %}
          </div>
          {% if not forloop.last %}<hr class="my-4 border-orange-200 dark:border-orange-900/50">{% endif %}
          {% endfor %}
        </div>
      </div>
      {% endif %}

      <!-- Education -->
      {% if resume.metadata.education %}
      <div class="bg-orange-50 dark:bg-gray-800 border border-orange-200 dark:border-orange-400/30 rounded-xl">
        <div class="p-6 pb-4">
          <h2 class="text-xl font-semibold flex items-center gap-2 dark:text-white">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
              <polyline points="14 2 14 8 20 8"/>
              <line x1="16" y1="13" x2="8" y2="13"/>
              <line x1="16" y1="17" x2="8" y2="17"/>
              <polyline points="10 9 9 9 8 9"/>
            </svg>
            Education
          </h2>
        </div>
        <div class="px-6 pb-6">
          {% for edu in resume.metadata.education %}
          <div class="mb-6 last:mb-0">
            <div class="flex justify-between items-start">
              <h3 class="font-semibold text-lg dark:text-white">{{ edu.degree }}</h3>
              <span class="text-sm text-orange-700 dark:text-orange-300 bg-orange-100 dark:bg-orange-900/40 px-2 py-1 rounded">
                {% if edu.end_date %}
                  {{ edu.start_date.year }} - {{ edu.end_date.year }}
                {% else %}
                  {{ edu.start_date.year }} - Present
                {% endif %}
              </span>
            </div>
            <p class="text-orange-700 dark:text-orange-300 font-medium">{{ edu.institution }}, {{ edu.location }}</p>

            {% if edu.field_of_study %}
            <p class="mt-1 text-orange-800 dark:text-orange-200">Field of Study: {{ edu.field_of_study }}</p>
            {% endif %}

            {% if edu.gpa %}
            <p class="mt-1 text-orange-800 dark:text-orange-200">GPA: {{ edu.gpa }}</p>
            {% endif %}

            {% if edu.honors %}
            <div class="mt-2">
              <h4 class="font-medium text-orange-900 dark:text-orange-200">Honors:</h4>
              <div class="flex flex-wrap gap-2 mt-1">
                {% for honor in edu.honors %}
                <span class="px-2 py-1 text-xs font-medium rounded bg-orange-100 text-orange-800 dark:bg-orange-900/40 dark:text-orange-200">{{ honor }}</span>
                {% endfor %}
              </div>
            </div>
            {% endif %}
          </div>
          {% if not forloop.last %}<hr class="my-4 border-orange-200 dark:border-orange-900/50">{% endif %}
          {% endfor %}
        </div>
      </div>
      {% endif %}
    </div>

    <!-- Right Column (1/3 width) -->
    <div class="space-y-6">
      <!-- File Information -->
      <div class="bg-white dark:bg-orange-900/20 border border-orange-200 dark:border-orange-900/50 rounded-xl">
        <div class="p-6 pb-4 text-xl font-semibold">File Information</div>
        <div class="px-6 pb-6 text-sm text-orange-800 dark:text-orange-200 space-y-4">
          <div class="flex items-center gap-3">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-orange-500" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"/>
              <path d="M14 2v4a2 2 0 0 0 2 2h4"/>
            </svg>
            <div>
              <p class="font-medium dark:text-white">File Name</p>
              <p class="text-orange-700 dark:text-orange-300">{{ resume.file.name }}</p>
            </div>
          </div>
          <div class="flex items-center gap-3">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-orange-500" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
              <polyline points="7 10 12 15 17 10"/>
              <line x1="12" x2="12" y1="15" y2="3"/>
            </svg>
            <div>
              <p class="font-medium dark:text-white">File Size</p>
              <p class="text-orange-700 dark:text-orange-300">{{ resume.file.size|filesizeformat }}</p>
            </div>
          </div>
          <div class="flex items-center gap-3">
            <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-orange-500" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M8 2v4"/>
              <path d="M16 2v4"/>
              <rect width="18" height="18" x="3" y="4" rx="2"/>
              <path d="M3 10h18"/>
            </svg>
            <div>
              <p class="font-medium dark:text-white">Upload Date</p>
              <p class="text-orange-700 dark:text-orange-300">{{ resume.created_at|date:"M j, Y" }}</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Technical Skills -->
      {% if resume.metadata.technical_skills %}
      <div class="bg-white dark:bg-orange-900/20 border border-orange-200 dark:border-orange-900/50 rounded-xl">
        <div class="p-6 pb-4 text-xl font-semibold">Technical Skills</div>
        <div class="px-6 pb-6">
          <div class="flex flex-wrap gap-2">
            {% for skill in resume.metadata.technical_skills %}
              <span class="px-2 py-1 text-xs font-semibold rounded bg-blue-100 text-blue-800 border border-blue-200 dark:bg-blue-900/40 dark:text-blue-200 dark:border-blue-900/50">{{ skill.name }}</span>
            {% endfor %}
          </div>
        </div>
      </div>
      {% endif %}

      <!-- Languages -->
      {% if resume.metadata.languages %}
      <div class="bg-white dark:bg-orange-900/20 border border-orange-200 dark:border-orange-900/50 rounded-xl">
        <div class="p-6 pb-4 text-xl font-semibold">Languages</div>
        <div class="px-6 pb-6">
          <div class="space-y-2">
            {% for language in resume.metadata.languages %}
            <div class="flex justify-between items-center">
              <span class="text-sm font-medium dark:text-white">{{ language.language }}</span>
              <span class="text-xs px-2 py-1 rounded bg-orange-100 text-orange-800 border border-orange-200 dark:bg-orange-900/40 dark:text-orange-200 dark:border-orange-900/50 capitalize">{{ language.proficiency }}</span>
            </div>
            {% endfor %}
          </div>
        </div>
      </div>
      {% endif %}

      <!-- Certifications -->
      {% if resume.metadata.certifications %}
      <div class="bg-white dark:bg-orange-900/20 border border-orange-200 dark:border-orange-900/50 rounded-xl">
        <div class="p-6 pb-4 text-xl font-semibold">Certifications</div>
        <div class="px-6 pb-6">
          <div class="space-y-4">
            {% for cert in resume.metadata.certifications %}
            <div>
              <h4 class="font-medium dark:text-white">{{ cert.name }}</h4>
              <p class="text-sm text-orange-700 dark:text-orange-300">{{ cert.issuing_organization }}</p>
              {% if cert.issue_date %}
              <p class="text-xs text-orange-600 dark:text-orange-300 mt-1">Issued {{ cert.issue_date.month }}/{{ cert.issue_date.year }}</p>
              {% endif %}
            </div>
            {% endfor %}
          </div>
        </div>
      </div>
      {% endif %}
    </div>
  </div>
</div>
{% endblock %}